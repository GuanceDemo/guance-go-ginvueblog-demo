var h=(N,d,n)=>new Promise((v,p)=>{var _=t=>{try{u(n.next(t))}catch(m){p(m)}},b=t=>{try{u(n.throw(t))}catch(m){p(m)}},u=t=>t.done?v(t.value):Promise.resolve(t.value).then(_,b);u((n=n.apply(N,d)).next())});import{_ as q}from"./CrudModal-8441a1a6.js";import{_ as z}from"./UploadOne-0ce475ec.js";import{_ as O}from"./CommonPage-328ed173.js";import{k as c,r as w,p as P,o as x,c as V,w as o,a as s,b as $,u as e,N as L,d as r,Z as C,ab as T,aa as j,b0 as E,q as A,b1 as M,B as Z,t as G,y as I}from"./index-f53dfd2d.js";import{u as H}from"./useCRUD-6648f9c7.js";import{N as J,a as f}from"./FormItem-9890d329.js";import{N as y}from"./Input-d1b207b8.js";import{N as K}from"./Image-3871d8d9.js";import"./Upload-33df3990.js";import"./Add-8e2e4207.js";import"./AppPage-64321f57.js";import"./utils-faaa8f65.js";const Q=r("span",{class:"i-material-symbols:add mr-5 text-18"},null,-1),W={class:"flex flex-wrap justify-between"},X={class:"absolute right-10 top-5 text-white"},Y=r("span",{class:"i-ion:ellipsis-horizontal h-20 w-20 text-white hover:text-blue"},null,-1),ee={class:"text-15"},te=r("div",{class:"h-0 w-300"},null,-1),le=r("div",{class:"h-0 w-300"},null,-1),ae=r("div",{class:"h-0 w-300"},null,-1),se={class:"w-full flex items-center justify-between"},ge={__name:"index",setup(N){const{modalVisible:d,modalTitle:n,modalLoading:v,handleAdd:p,handleDelete:_,handleEdit:b,handleSave:u,modalForm:t,modalFormRef:m}=H({name:"页面",initForm:{},doCreate:c.saveOrUpdatePage,doDelete:c.deletePage,doUpdate:c.saveOrUpdatePage,refresh:F}),k=w([]),g=w(!1),U=w(null);P(()=>h(this,null,function*(){F()}));function F(){return h(this,null,function*(){const i=yield c.getPages();k.value=i.data})}function S(i){g.value=!0,U.value.previewImg=i,setTimeout(()=>g.value=!1,1e3)}function B(i,l){i==="edit"?b(l):i==="delete"&&_([l.id])}const D=[{label:"编辑",key:"edit",icon:I("mingcute:edit-2-line",{size:"15px"})},{label:"删除",key:"delete",icon:I("mingcute:delete-back-line",{size:"15px"})}];return(i,l)=>(x(),V(O,{title:"页面管理"},{action:o(()=>[s(e(L),{type:"primary",onClick:e(p)},{default:o(()=>[Q,$(" 新建页面 ")]),_:1},8,["onClick"])]),default:o(()=>[r("div",W,[(x(!0),C(j,null,T(k.value,a=>(x(),C("div",{key:a.id,class:"relative my-10 w-300 cursor-pointer text-center"},[r("div",X,[s(e(M),{options:D,onSelect:R=>B(R,a)},{default:o(()=>[Y]),_:2},1032,["onSelect"])]),s(e(K),{src:e(Z)(a.cover),height:"170",width:"300","img-props":{style:{"border-radius":"5px"}}},null,8,["src"]),r("p",ee,G(a.name),1)]))),128)),te,le,ae]),s(q,{visible:e(d),"onUpdate:visible":l[6]||(l[6]=a=>A(d)?d.value=a:null),width:"550px",title:e(n),loading:e(v),onSave:e(u)},{default:o(()=>[s(e(J),{ref_key:"modalFormRef",ref:m,"label-placement":"left","label-align":"left","label-width":80,model:e(t)},{default:o(()=>[s(e(f),{label:"页面名称",path:"name",rule:{required:!0,message:"请输入页面名称",trigger:["input","blur"]}},{default:o(()=>[s(e(y),{value:e(t).name,"onUpdate:value":l[0]||(l[0]=a=>e(t).name=a),placeholder:"页面名称"},null,8,["value"])]),_:1}),s(e(f),{label:"页面标签",path:"label",rule:{required:!0,message:"请输入页面标签",trigger:["input","blur"]}},{default:o(()=>[s(e(y),{value:e(t).label,"onUpdate:value":l[1]||(l[1]=a=>e(t).label=a),placeholder:"页面标签"},null,8,["value"])]),_:1}),s(e(f),{label:"页面封面",path:"cover",rule:{required:!0,message:"请上传封面图片",trigger:["input","blur"]}},{default:o(()=>[r("div",se,[s(z,{ref_key:"uploadOneRef",ref:U,preview:e(t).cover,"onUpdate:preview":l[2]||(l[2]=a=>e(t).cover=a),width:300,onFinish:l[3]||(l[3]=a=>e(t).cover=a)},null,8,["preview"]),r("span",{class:E(["i-uiw:reload h-20 w-20 cursor-pointer",g.value?"animate-spin":""]),onClick:l[4]||(l[4]=a=>S(e(t).cover))},null,2)])]),_:1}),s(e(f),{label:"封面链接",path:"cover",rule:{required:!0,message:"请输入封面链接",trigger:["input","blur"]}},{default:o(()=>[s(e(y),{value:e(t).cover,"onUpdate:value":l[5]||(l[5]=a=>e(t).cover=a),type:"textarea",placeholder:"图片上传成功自动生成，或者直接复制外链"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","loading","onSave"])]),_:1}))}};export{ge as default};
